---
import "../styles/global.css";
import { ViewTransitions } from "astro:transitions";
import { getCollection } from "astro:content";
import ManifestoNav from "../components/ManifestoNav";
import ManifestoContent from "../components/ManifestoContent";

// Load manifesto content from collection
const manifestoEntries = await getCollection("manifesto");
const sortedEntries = manifestoEntries.sort((a, b) =>
    a.data.number.localeCompare(b.data.number),
);

// Prepare data for SolidJS components
const manifesto = sortedEntries.map((entry) => ({
    number: entry.data.number,
    title: entry.data.title,
    content: entry.body,
    illustration: entry.data.illustration,
}));

const navItems = sortedEntries.map((entry) => ({
    number: entry.data.number,
    title: entry.data.title,
    slug: entry.id,
}));
---

<!doctype html>
<html lang="ar" dir="rtl">
    <head>
        <meta charset="utf-8" />
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content={Astro.generator} />
        <meta
            name="description"
            content="تَقِن: مَنْبَتُ المَهَرَة، ودَارُ المُلازَمَة. نجمعُ النَّشْءَ بالأَسَاطِين، لِيَرِثوا سِرَّ الصَّنْعَة."
        />
        <title>تَقِن | الإشارات</title>
        <ViewTransitions />
    </head>
    <body>
        <div class="home-layout">
            <ManifestoNav client:load items={navItems} />
            <ManifestoContent client:load items={manifesto} />
        </div>
    </body>
</html>
