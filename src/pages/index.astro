---
import HomeLayout from "../layouts/HomeLayout.astro";
import { getCollection } from "astro:content";
import ManifestoNav from "../components/ManifestoNav";
import ManifestoContent from "../components/ManifestoContent";
import TopBar from "../components/TopBar";

// Load manifesto content from collection
const manifestoEntries = await getCollection("manifesto");
const sortedEntries = manifestoEntries.sort((a, b) =>
    a.data.number.localeCompare(b.data.number),
);

// Prepare data for SolidJS components
const manifesto = sortedEntries.map((entry) => ({
    number: entry.data.number,
    title: entry.data.title,
    content: entry.body,
    illustration: entry.data.illustration,
}));

const navItems = sortedEntries.map((entry) => ({
    number: entry.data.number,
    title: entry.data.title,
    slug: entry.id,
}));
---

<HomeLayout
    pageTitle="تَقِن: مَنْبَتُ المَهَرَة، ودَارُ المُلازَمَة"
    description="تَقِن: مَنْبَتُ المَهَرَة، ودَارُ المُلازَمَة. نجمعُ النَّشْءَ بالأَسَاطِين، لِيَرِثوا سِرَّ الصَّنْعَة."
>
    <ManifestoNav client:load items={navItems} />
    <div class="content-wrapper">
        <TopBar />
        <ManifestoContent client:load items={manifesto} />
    </div>
</HomeLayout>
